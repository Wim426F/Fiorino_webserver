<!DOCTYPE html>
<html>

<head>
    <title>
        Datalog
    </title>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script>
        function editlog(element) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/datalog?function=" + element.id, true);
            xhr.send();
            if (element.id == 'delete') {
                location.reload();
            }
        }
    </script>
</head>

<body class="body">
    <div class="parent">
        <p class="textstyle">
            Manage Datalogging
        </p>
        <div>
            <span class="button" id="delete" onclick="editlog(this)">Delete Logfile</span>
            <input class="button" type="button" id="download" value="Download Logfile" />

            <script>
                var dt = new Date();
                var datetime = dt.toLocaleString();

                // Download function
                function download(filename, text) {
                    var element = document.createElement('a');
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                    element.setAttribute('download', filename);

                    element.style.display = 'none';
                    document.body.appendChild(element);
                    element.click();
                    document.body.removeChild(element);
                }

                // Start file download.
                document.getElementById("download").addEventListener("click", function () {
                    // Generate download of hello.txt file with some content
                    var text = document.getElementById("logfile").value;
                    var filename = "logfile_" + datetime + ".csv";

                    download(filename, text);
                }, false);
            </script>
        </div>
    </div>

    <div class="parent">
            <textarea id="logfile" class="textblock" data="logfile" name="Logfile"></textarea>
    </div>

    <hr class="line">

    <div class="parent">
        <span class="button" id="return" onclick="window.location.href = '/'">Return to Home</span>
    </div>

</body>

</html>