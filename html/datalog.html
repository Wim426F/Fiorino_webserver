<!DOCTYPE html>
<html>

<head>
    <title>
        Datalog
    </title>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script>
        function editlog(element) {
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/datalog?function=" + element.id, true);
            xhr.send();
            if (element.id == 'delete') {
                location.reload();
            }
        }
    </script>
</head>

<body class="body">
    <div class="parent">
        <div>
            <!--<object class="logstyle" data="logfile" type="text/plain"></object>-->
            <textarea id="logfile" class="textblock" data="logfile" name="Logfile"></textarea>
        </div>
    </div>
    <div class="parent">
        <p class="textstyle">
            Manage Datalogging
        </p>
        %BUTTONPLACEHOLDER%
        <div>
            <span class="button" id="delete" onclick="editlog(this)">Delete Logfile</span>
            <!--<span class="button" id="download">Download Logfile</span>-->
            <input class="button" type="button" id="download" value="Download" />
            <script>
                function download(filename, text) {
                    var element = document.createElement('a');
                    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                    element.setAttribute('download', filename);

                    element.style.display = 'none';
                    document.body.appendChild(element);

                    element.click();

                    document.body.removeChild(element);
                }

                // Start file download.
                document.getElementById("download").addEventListener("click", function () {
                    // Generate download of hello.txt file with some content
                    var text = document.getElementById("logfile").value;
                    var filename = "logfile.txt";

                    download(filename, text);
                }, false);

            </script>
        </div>
    </div>
    <div class="spacer"></div>
    <div class="parent">
        <span class="button" id="return" onclick="window.location.href = '/'">Return to Home</span>
    </div>
</body>

</html>